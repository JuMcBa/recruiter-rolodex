<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recruiter Rolodex</title>
  <script src="https://unpkg.com/react@18.3.1/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone@7.26.9/babel.min.js" crossorigin></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Apple-inspired colors */
    .apple-blue { background-color: #0071E3; }
    .apple-blue-hover:hover { background-color: #005BB5; }
    .apple-dark-gray { color: #1D1D1F; }
    .apple-medium-gray { color: #6E6E73; }
    .apple-light-gray { background-color: #F5F5F7; }
    .apple-white { background-color: #FFFFFF; }
    .apple-focus-ring { outline: none; ring: 2px #0071E3; }
    /* Smooth transitions */
    .apple-transition { transition: all 200ms ease-in-out; }
    /* San Francisco-like typography */
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    /* Custom hover scale */
    .hover-scale:hover { transform: scale(1.05); }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    console.log('Starting Recruiter Rolodex application at', new Date().toISOString());
    const DEFAULT_PHOTO = 'https://via.placeholder.com/150?text=No+Photo';
    const GENERIC_LOGO = 'https://www.clipartmax.com/png/small/75-756149_big-image-generic-logo-png-transparent.png'; // New generic logo

    // Global rating colors for consistent styling
    const ratingColors = {
      Gold: 'bg-yellow-400 text-yellow-900',
      Silver: 'bg-gray-400 text-gray-900',
      Bronze: 'bg-orange-600 text-white'
    };

    const sampleCandidates = [
      { id: 1, name: "Alice Johnson", function: "Software Engineer", company: "TechTrend Innovations", linkedin: "https://linkedin.com/in/alicejohnson", comments: "Strong coding skills.", keywords: ["React", "Node.js"], rating: "Gold", remarks: [{ id: 1, text: "Excellent team player", createdAt: "2025-05-01T10:00:00Z" }], createdAt: "2025-05-01T10:00:00Z", updatedAt: "2025-05-01T10:00:00Z" },
      { id: 2, name: "Bob Martinez", function: "Product Manager", company: "GrowEasy Solutions", linkedin: "https://linkedin.com/in/bobmartinez", comments: "Great collaborator.", keywords: ["Scrum", "UX"], rating: "Silver", remarks: [{ id: 1, text: "Strong leadership", createdAt: "2025-05-02T12:00:00Z" }], createdAt: "2025-05-02T12:00:00Z", updatedAt: "2025-05-02T12:00:00Z" },
      { id: 3, name: "Clara Nguyen", function: "Data Scientist", company: "DataCore Analytics", linkedin: "https://linkedin.com/in/claranguyen", comments: "ML expert.", keywords: ["Python", "Machine Learning"], rating: "Gold", remarks: [{ id: 1, text: "Innovative approach", createdAt: "2025-05-03T14:00:00Z" }], createdAt: "2025-05-03T14:00:00Z", updatedAt: "2025-05-03T14:00:00Z" },
      { id: 4, name: "David Kim", function: "UX Designer", company: "CreativeLabs", linkedin: "https://linkedin.com/in/davidkim", comments: "Skilled in Figma.", keywords: ["UX Design", "Figma"], rating: "Bronze", remarks: [{ id: 1, text: "Needs more experience", createdAt: "2025-05-04T09:00:00Z" }], createdAt: "2025-05-04T09:00:00Z", updatedAt: "2025-05-04T09:00:00Z" },
      { id: 5, name: "Emma Patel", function: "DevOps Engineer", company: "CloudPeak Systems", linkedin: "https://linkedin.com/in/emmapatel", comments: "AWS proficient.", keywords: ["AWS", "Kubernetes"], rating: "Silver", remarks: [{ id: 1, text: "Reliable", createdAt: "2025-05-05T11:00:00Z" }], createdAt: "2025-05-05T11:00:00Z", updatedAt: "2025-05-05T11:00:00Z" },
      { id: 6, name: "Frank Wilson", function: "Marketing Manager", company: "BrandBoost Inc.", linkedin: "https://linkedin.com/in/frankwilson", comments: "Creative strategist.", keywords: ["Marketing", "SEO"], rating: "Gold", remarks: [{ id: 1, text: "Great campaigns", createdAt: "2025-05-06T13:00:00Z" }], createdAt: "2025-05-06T13:00:00Z", updatedAt: "2025-05-06T13:00:00Z" },
      { id: 7, name: "Grace Lee", function: "Frontend Developer", company: "WebWave Technologies", linkedin: "https://linkedin.com/in/gracelee", comments: "Vue.js expert.", keywords: ["Vue.js", "TypeScript"], rating: "Silver", remarks: [{ id: 1, text: "Fast learner", createdAt: "2025-05-07T15:00:00Z" }], createdAt: "2025-05-07T15:00:00Z", updatedAt: "2025-05-07T15:00:00Z" },
      { id: 8, name: "Henry Brown", function: "Cybersecurity Analyst", company: "SecureNet Solutions", linkedin: "https://linkedin.com/in/henrybrown", comments: "Threat analysis.", keywords: ["Cybersecurity"], rating: "Bronze", remarks: [{ id: 1, text: "Detail-oriented", createdAt: "2025-05-08T10:00:00Z" }], createdAt: "2025-05-08T10:00:00Z", updatedAt: "2025-05-08T10:00:00Z" },
      { id: 9, name: "Isabella Garcia", function: "HR Specialist", company: "PeopleFirst Corp", linkedin: "https://linkedin.com/in/isabellagarcia", comments: "Talent acquisition.", keywords: ["HR", "Recruiting"], rating: "Gold", remarks: [{ id: 1, text: "Effective recruiter", createdAt: "2025-05-09T12:00:00Z" }], createdAt: "2025-05-09T12:00:00Z", updatedAt: "2025-05-09T12:00:00Z" },
      { id: 10, name: "James Thompson", function: "Backend Developer", company: "CodeCraft Systems", linkedin: "https://linkedin.com/in/jamesthompson", comments: "Java expert.", keywords: ["Java", "Spring Boot"], rating: "Silver", remarks: [{ id: 1, text: "Solid coder", createdAt: "2025-05-10T14:00:00Z" }], createdAt: "2025-05-10T14:00:00Z", updatedAt: "2025-05-10T14:00:00Z" },
      { id: 11, name: "Katherine Evans", function: "Business Analyst", company: "InsightConsulting", linkedin: "https://linkedin.com/in/katherineevans", comments: "Requirement gathering.", keywords: ["Business Analysis"], rating: "Bronze", remarks: [{ id: 1, text: "Good communicator", createdAt: "2025-05-11T09:00:00Z" }], createdAt: "2025-05-11T09:00:00Z", updatedAt: "2025-05-11T09:00:00Z" },
      { id: 12, name: "Liam Carter", function: "Mobile Developer", company: "AppVenture Studio", linkedin: "https://linkedin.com/in/liamcarter", comments: "Flutter expert.", keywords: ["Flutter", "Swift"], rating: "Gold", remarks: [{ id: 1, text: "Creative apps", createdAt: "2025-05-12T11:00:00Z" }], createdAt: "2025-05-12T11:00:00Z", updatedAt: "2025-05-12T11:00:00Z" },
      { id: 13, name: "Mia Rodriguez", function: "Content Writer", company: "WordSmith Media", linkedin: "https://linkedin.com/in/miarodriguez", comments: "Engaging content.", keywords: ["Content Writing", "SEO"], rating: "Silver", remarks: [{ id: 1, text: "Great writer", createdAt: "2025-05-13T13:00:00Z" }], createdAt: "2025-05-13T13:00:00Z", updatedAt: "2025-05-13T13:00:00Z" },
      { id: 14, name: "Noah Davis", function: "Cloud Architect", company: "SkyHigh Technologies", linkedin: "https://linkedin.com/in/noahdavis", comments: "Scalable solutions.", keywords: ["Azure"], rating: "Gold", remarks: [{ id: 1, text: "Expert architect", createdAt: "2025-05-14T15:00:00Z" }], createdAt: "2025-05-14T15:00:00Z", updatedAt: "2025-05-14T15:00:00Z" },
      { id: 15, name: "Olivia Clark", function: "Graphic Designer", company: "PixelPerfect Studio", linkedin: "https://linkedin.com/in/oliviaclark", comments: "Creative designs.", keywords: ["Graphic Design"], rating: "Bronze", remarks: [{ id: 1, text: "Promising talent", createdAt: "2025-05-15T10:00:00Z" }], createdAt: "2025-05-15T10:00:00Z", updatedAt: "2025-05-15T10:00:00Z" },
      { id: 16, name: "Peter Harris", function: "Project Manager", company: "PlanWise Solutions", linkedin: "https://linkedin.com/in/peterharris", comments: "Certified PMP.", keywords: ["Project Management"], rating: "Silver", remarks: [{ id: 1, text: "Organized leader", createdAt: "2025-05-16T12:00:00Z" }], createdAt: "2025-05-16T12:00:00Z", updatedAt: "2025-05-16T12:00:00Z" },
      { id: 17, name: "Quinn Lopez", function: "AI Engineer", company: "IntelliCore Labs", linkedin: "https://linkedin.com/in/quinnlopez", comments: "Deep learning expert.", keywords: ["AI", "TensorFlow"], rating: "Gold", remarks: [{ id: 1, text: "Innovative models", createdAt: "2025-05-17T14:00:00Z" }], createdAt: "2025-05-17T14:00:00Z", updatedAt: "2025-05-17T14:00:00Z" },
      { id: 18, name: "Rachel White", function: "Sales Manager", company: "GrowFast Enterprises", linkedin: "https://linkedin.com/in/rachelwhite", comments: "Strong client skills.", keywords: ["Sales", "CRM"], rating: "Silver", remarks: [{ id: 1, text: "Top performer", createdAt: "2025-05-18T09:00:00Z" }], createdAt: "2025-05-18T09:00:00Z", updatedAt: "2025-05-18T09:00:00Z" },
      { id: 19, name: "Samuel Green", function: "Database Administrator", company: "DataVault Systems", linkedin: "https://linkedin.com/in/samuelgreen", comments: "SQL optimizer.", keywords: ["SQL"], rating: "Bronze", remarks: [{ id: 1, text: "Reliable admin", createdAt: "2025-05-18T11:00:00Z" }], createdAt: "2025-05-18T11:00:00Z", updatedAt: "2025-05-18T11:00:00Z" },
      { id: 20, name: "Tara Adams", function: "Quality Assurance Engineer", company: "TestRight Solutions", linkedin: "https://linkedin.com/in/taraadams", comments: "Automated testing.", keywords: ["QA", "Selenium"], rating: "Gold", remarks: [{ id: 1, text: "Thorough tester", createdAt: "2025-05-18T13:00:00Z" }], createdAt: "2025-05-18T13:00:00Z", updatedAt: "2025-05-18T13:00:00Z" }
    ];

    try {
      console.log('Loading CDN scripts...');
      if (!window.React) throw new Error('React CDN script not loaded');
      if (!window.ReactDOM) throw new Error('ReactDOM CDN script not loaded');
      if (!window.Babel) throw new Error('Babel CDN script not loaded');
      console.log('CDN scripts loaded successfully');

      function App() {
        console.log('Initializing App component...');
        const [candidates, setCandidates] = React.useState(() => {
          try {
            const saved = localStorage.getItem('candidates');
            console.log('Retrieved from localStorage:', saved ? 'Data found' : 'No data, using sampleCandidates');
            const parsed = saved ? JSON.parse(saved) : sampleCandidates;
            console.log('Initial candidates:', parsed.length, 'candidates', parsed.map(c => c.name));
            return parsed;
          } catch (e) {
            console.error('Error parsing localStorage:', e.message, e.stack);
            console.log('Falling back to sampleCandidates');
            return sampleCandidates;
          }
        });
        const [searchTerm, setSearchTerm] = React.useState('');
        const [ratingFilter, setRatingFilter] = React.useState('All');
        const [showModal, setShowModal] = React.useState(false);
        const [modalMode, setModalMode] = React.useState('add'); // 'add', 'edit', 'view'
        const [editingCandidate, setEditingCandidate] = React.useState(null);
        const [viewingCandidate, setViewingCandidate] = React.useState(null);

        React.useEffect(() => {
          try {
            console.log('Saving candidates to localStorage:', candidates.length, 'candidates', candidates.map(c => c.name));
            localStorage.setItem('candidates', JSON.stringify(candidates));
            console.log('Saved candidates to localStorage');
          } catch (e) {
            console.error('Error saving to localStorage:', e.message, e.stack);
          }
        }, [candidates]);

        const addCandidate = (candidate) => {
          try {
            console.log('Received candidate data:', candidate);
            const newCandidate = {
              id: Date.now(),
              name: candidate.name ? candidate.name.trim() : '',
              function: candidate.function ? candidate.function.trim() : '',
              company: candidate.company ? candidate.company.trim() : '',
              linkedin: candidate.linkedin ? candidate.linkedin.trim() : '',
              comments: candidate.comments ? candidate.comments.trim() : '',
              keywords: Array.isArray(candidate.keywords) ? candidate.keywords.map(k => k.trim()).filter(k => k) : [],
              rating: candidate.rating || 'Bronze',
              remarks: Array.isArray(candidate.remarks) ? candidate.remarks : [],
              createdAt: new Date().toISOString(),
              updatedAt: new Date().toISOString()
            };
            console.log('Adding candidate:', newCandidate);
            if (!newCandidate.name || !newCandidate.function || !newCandidate.company) {
              throw new Error('Name, Function, and Company are required.');
            }
            setCandidates(prev => {
              const updated = [newCandidate, ...prev];
              console.log('New candidates state:', updated.length, 'candidates', updated.map(c => c.name));
              return [...updated];
            });
            setShowModal(false);
            console.log('Modal closed after adding candidate');
          } catch (e) {
            console.error('Error adding candidate:', e.message, e.stack);
            throw e;
          }
        };

        const updateCandidate = (updatedCandidate) => {
          try {
            console.log('Received updated candidate:', updatedCandidate);
            const updated = {
              ...updatedCandidate,
              name: updatedCandidate.name ? updatedCandidate.name.trim() : '',
              function: updatedCandidate.function ? updatedCandidate.function.trim() : '',
              company: updatedCandidate.company ? updatedCandidate.company.trim() : '',
              linkedin: updatedCandidate.linkedin ? updatedCandidate.linkedin.trim() : '',
              comments: updatedCandidate.comments ? updatedCandidate.comments.trim() : '',
              keywords: Array.isArray(updatedCandidate.keywords) ? updatedCandidate.keywords.map(k => k.trim()).filter(k => k) : [],
              rating: updatedCandidate.rating || 'Bronze',
              remarks: Array.isArray(updatedCandidate.remarks) ? updatedCandidate.remarks : [],
              updatedAt: new Date().toISOString()
            };
            console.log('Updating candidate:', updated);
            if (!updated.name || !updated.function || !updated.company) {
              throw new Error('Name, Function, and Company are required.');
            }
            setCandidates(prev => {
              const updatedList = prev.map(c => 
                c.id === updated.id ? updated : c
              );
              console.log('New candidates state:', updatedList.length, 'candidates', updatedList.map(c => c.name));
              return [...updatedList];
            });
            setShowModal(false);
            setEditingCandidate(null);
            console.log('Modal closed after updating candidate');
          } catch (e) {
            console.error('Error updating candidate:', e.message, e.stack);
            throw e;
          }
        };

        const deleteCandidate = (id) => {
          try {
            console.log('Deleting candidate with id:', id);
            setCandidates(prev => {
              const updated = prev.filter(c => c.id !== id);
              console.log('New candidates state:', updated.length, 'candidates', updated.map(c => c.name));
              return [...updated];
            });
          } catch (e) {
            console.error('Error deleting candidate:', e.message, e.stack);
          }
        };

        const filteredCandidates = candidates.filter(c => {
          try {
            const matchesSearch =
              (c.name || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
              (c.function || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
              (c.company || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
              (c.comments || '').toLowerCase().includes(searchTerm.toLowerCase()) ||
              (c.keywords || []).some(k => k.toLowerCase().includes(searchTerm.toLowerCase()));
            const matchesRating = ratingFilter === 'All' || c.rating === ratingFilter;
            return matchesSearch && matchesRating;
          } catch (e) {
            console.error('Error filtering candidates:', e.message, e.stack);
            return false;
          }
        });

        const recentCandidates = candidates
          .slice()
          .sort((a, b) => {
            const aDate = new Date(a.updatedAt || a.createdAt);
            const bDate = new Date(b.updatedAt || b.createdAt);
            return bDate - aDate;
          })
          .slice(0, 6);

        console.log('Rendering with showModal:', showModal, 'modalMode:', modalMode, 'ratingFilter:', ratingFilter, 'recent candidates:', recentCandidates.map(c => c.name));

        return (
          <div className="min-h-screen apple-light-gray p-6">
            <div className="max-w-7xl mx-auto">
              <h1 className="text-3xl font-semibold mb-8 text-center apple-dark-gray">Recruiter Rolodex</h1>
              {!showModal && (
                <div className="mb-8">
                  <div className="flex gap-4 items-center">
                    <input
                      type="text"
                      placeholder="Search candidates..."
                      value={searchTerm}
                      onChange={(e) => {
                        setSearchTerm(e.target.value);
                        console.log('Search term updated:', e.target.value);
                      }}
                      className="flex-1 p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] shadow-sm apple-white font-sans"
                    />
                    <button
                      onClick={() => {
                        setModalMode('add');
                        setShowModal(true);
                        console.log('Opening add candidate modal');
                      }}
                      className="apple-blue text-white px-6 py-3 rounded-lg apple-blue-hover shadow-sm font-medium font-sans apple-transition"
                    >
                      Add Candidate
                    </button>
                  </div>
                  <div className="mt-4">
                    <label className="block text-sm font-medium apple-dark-gray mb-2">Filter by Rating</label>
                    <div className="flex gap-2">
                      {['All', 'Bronze', 'Silver', 'Gold'].map(rating => (
                        <button
                          key={rating}
                          onClick={() => {
                            setRatingFilter(rating);
                            console.log('Rating filter updated:', rating);
                          }}
                          className={`flex-1 py-2 px-3 rounded-lg font-sans text-sm font-medium apple-transition ${
                            ratingFilter === rating
                              ? 'apple-blue text-white'
                              : 'bg-gray-200 text-gray-800 hover:bg-gray-300'
                          }`}
                        >
                          <span className="flex items-center justify-center gap-1">
                            {rating === 'Bronze' && 'ðŸ¥‰'}
                            {rating === 'Silver' && 'ðŸ¥ˆ'}
                            {rating === 'Gold' && 'ðŸ¥‡'}
                            {rating}
                          </span>
                        </button>
                      ))}
                    </div>
                  </div>
                </div>
              )}
              {showModal && (
                <CandidateModal
                  mode={modalMode}
                  candidate={modalMode === 'view' ? viewingCandidate : editingCandidate}
                  onClose={() => {
                    setShowModal(false);
                    setEditingCandidate(null);
                    setViewingCandidate(null);
                    setModalMode('add');
                    console.log('Closed modal');
                  }}
                  onSave={modalMode === 'edit' ? updateCandidate : addCandidate}
                />
              )}
              {!showModal && (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                  {(searchTerm || ratingFilter !== 'All' ? filteredCandidates : recentCandidates).map(candidate => {
                    console.log('Rendering compact tile for:', candidate.name, 'Size: 25% smaller, enhanced visuals');
                    return (
                      <CandidateCard
                        key={candidate.id}
                        candidate={candidate}
                        onView={() => {
                          setViewingCandidate(candidate);
                          setModalMode('view');
                          setShowModal(true);
                          console.log('Viewing candidate:', candidate.name);
                        }}
                        onEdit={() => {
                          setEditingCandidate(candidate);
                          setModalMode('edit');
                          setShowModal(true);
                          console.log('Editing candidate:', candidate.name);
                        }}
                        onDelete={() => {
                          deleteCandidate(candidate.id);
                          console.log('Deleting candidate:', candidate.name);
                        }}
                      />
                    );
                  })}
                </div>
              )}
              {!showModal && !searchTerm && ratingFilter === 'All' && recentCandidates.length === 0 && (
                <p className="text-center apple-medium-gray mt-4 text-sm font-sans">No recent candidates available.</p>
              )}
              <div className="mt-8 flex justify-center">
                <img src={GENERIC_LOGO} alt="Generic Logo" className="h-8 apple-medium-gray" />
              </div>
            </div>
          </div>
        );
      }

      function CandidateModal({ mode, candidate, onClose, onSave }) {
        const [formData, setFormData] = React.useState({
          name: candidate?.name || '',
          function: candidate?.function || '',
          company: candidate?.company || '',
          linkedin: candidate?.linkedin || '',
          comments: candidate?.comments || '',
          keywords: candidate?.keywords || [],
          rating: candidate?.rating || 'Bronze',
          remarks: candidate?.remarks || []
        });
        const [error, setError] = React.useState('');
        const [newRemark, setNewRemark] = React.useState('');
        const [editingRemarkId, setEditingRemarkId] = React.useState(null);
        const [editingRemarkText, setEditingRemarkText] = React.useState('');

        const handleSubmit = (e) => {
          e.preventDefault();
          setError('');
          try {
            console.log('Form submitted with data:', formData);
            onSave(formData);
            console.log('Form data sent to onSave');
          } catch (e) {
            console.error('Error submitting form:', e.message, e.stack);
            setError(e.message || 'Failed to save candidate. Please try again.');
          }
        };

        const addKeyword = (keyword) => {
          try {
            if (formData.keywords.length < 10 && keyword.trim()) {
              setFormData({
                ...formData,
                keywords: [...formData.keywords, keyword.trim()]
              });
              console.log('Added keyword:', keyword);
            }
          } catch (e) {
            console.error('Error adding keyword:', e.message, e.stack);
          }
        };

        const removeKeyword = (index) => {
          try {
            setFormData({
              ...formData,
              keywords: formData.keywords.filter((_, i) => i !== index)
            });
            console.log('Removed keyword at index:', index);
          } catch (e) {
            console.error('Error removing keyword:', e.message, e.stack);
          }
        };

        const addRemark = () => {
          try {
            if (newRemark.trim()) {
              const remark = {
                id: Date.now(),
                text: newRemark.trim(),
                createdAt: new Date().toISOString()
              };
              setFormData({
                ...formData,
                remarks: [...formData.remarks, remark]
              });
              setNewRemark('');
              console.log('Added remark:', remark);
            }
          } catch (e) {
            console.error('Error adding remark:', e.message, e.stack);
          }
        };

        const editRemark = (id, text) => {
          try {
            setEditingRemarkId(id);
            setEditingRemarkText(text);
            console.log('Editing remark ID:', id);
          } catch (e) {
            console.error('Error starting remark edit:', e.message, e.stack);
          }
        };

        const saveEditedRemark = () => {
          try {
            if (editingRemarkText.trim()) {
              setFormData({
                ...formData,
                remarks: formData.remarks.map(remark =>
                  remark.id === editingRemarkId
                    ? { ...remark, text: editingRemarkText.trim(), createdAt: new Date().toISOString() }
                    : remark
                )
              });
              setEditingRemarkId(null);
              setEditingRemarkText('');
              console.log('Saved edited remark ID:', editingRemarkId);
            }
          } catch (e) {
            console.error('Error saving edited remark:', e.message, e.stack);
          }
        };

        const removeRemark = (id) => {
          try {
            setFormData({
              ...formData,
              remarks: formData.remarks.filter(remark => remark.id !== id)
            });
            console.log('Removed remark ID:', id);
          } catch (e) {
            console.error('Error removing remark:', e.message, e.stack);
          }
        };

        return (
          <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
            <div className="apple-white p-6 rounded-2xl w-full max-w-md shadow-lg max-h-[90vh] overflow-y-auto bg-white/95 backdrop-blur-md">
              <h2 className="text-xl font-semibold mb-6 apple-dark-gray">
                {mode === 'view' ? 'View Candidate' : mode === 'edit' ? 'Edit Candidate' : 'Add Candidate'}
              </h2>
              {error && mode !== 'view' && (
                <p className="text-red-500 mb-4 text-sm font-sans">{error}</p>
              )}
              {mode === 'view' ? (
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Name</label>
                    <p className="text-sm apple-dark-gray font-sans">{formData.name}</p>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Function</label>
                    <p className="text-sm apple-dark-gray font-sans">{formData.function}</p>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Current Company</label>
                    <p className="text-sm apple-dark-gray font-sans">{formData.company}</p>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">LinkedIn Profile</label>
                    {formData.linkedin ? (
                      <a href={formData.linkedin} target="_blank" rel="noopener noreferrer" className="text-[#0071E3] hover:underline text-sm font-sans flex items-center gap-1">
                        <svg className="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.024-3.037-1.85-3.037-1.85 0-2.132 1.444-2.132 2.936v5.67H9.357V9h3.414v1.561h.048c.476-.9 1.636-1.85 3.365-1.85 3.602 0 4.263 2.37 4.263 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.93-2.063-2.077 0-1.147.92-2.077 2.063-2.077 1.143 0 2.063.93 2.063 2.077 0 1.147-.92 2.077-2.063 2.077zm1.777 13.019H3.56V9h3.554v11.452zM22.225 0H1.771C.792 0 0 .792 0 1.771v20.458C0 23.208.792 24 1.771 24h20.454c.979 0 1.771-.792 1.771-1.771V1.771C24 .792 23.208 0 22.225 0z"/>
                        </svg>
                        LinkedIn
                      </a>
                    ) : (
                      <p className="text-sm apple-medium-gray font-sans">None</p>
                    )}
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Recruiting Comments</label>
                    <p className="text-sm apple-dark-gray font-sans">{formData.comments || 'None'}</p>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Rating</label>
                    <span className={`px-2 py-1 rounded-full text-xs font-medium ${ratingColors[formData.rating]}`}>
                      {formData.rating}
                    </span>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Keywords</label>
                    <div className="flex flex-wrap gap-2 mt-2">
                      {formData.keywords.length > 0 ? (
                        formData.keywords.map((keyword, index) => (
                          <span key={index} className="bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs font-sans">
                            {keyword}
                          </span>
                        ))
                      ) : (
                        <p className="text-sm apple-medium-gray font-sans">None</p>
                      )}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray">Remarks</label>
                    {formData.remarks.length > 0 ? (
                      <ul className="space-y-2 mt-2">
                        {formData.remarks.map(remark => (
                          <li key={remark.id} className="text-sm apple-dark-gray font-sans">
                            {remark.text} <span className="text-xs apple-medium-gray">({new Date(remark.createdAt).toLocaleString()})</span>
                          </li>
                        ))}
                      </ul>
                    ) : (
                      <p className="text-sm apple-medium-gray font-sans mt-2">None</p>
                    )}
                  </div>
                  <div className="flex justify-end">
                    <button
                      type="button"
                      onClick={onClose}
                      className="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 text-sm font-medium font-sans apple-transition"
                    >
                      Close
                    </button>
                  </div>
                </div>
              ) : (
                <form onSubmit={handleSubmit} className="space-y-4">
                  <input
                    type="text"
                    placeholder="Name"
                    value={formData.name}
                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                    className="w-full p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                    required
                  />
                  <input
                    type="text"
                    placeholder="Function"
                    value={formData.function}
                    onChange={(e) => setFormData({ ...formData, function: e.target.value })}
                    className="w-full p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                    required
                  />
                  <input
                    type="text"
                    placeholder="Current Company"
                    value={formData.company}
                    onChange={(e) => setFormData({ ...formData, company: e.target.value })}
                    className="w-full p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                    required
                  />
                  <input
                    type="url"
                    placeholder="LinkedIn Profile"
                    value={formData.linkedin}
                    onChange={(e) => setFormData({ ...formData, linkedin: e.target.value })}
                    className="w-full p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                  />
                  <textarea
                    placeholder="Recruiting Comments"
                    value={formData.comments}
                    onChange={(e) => setFormData({ ...formData, comments: e.target.value })}
                    className="w-full p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                    rows="4"
                  ></textarea>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray mb-2">Rating</label>
                    <div className="flex items-center gap-4">
                      <input
                        type="range"
                        min="1"
                        max="3"
                        value={formData.rating === 'Gold' ? 3 : formData.rating === 'Silver' ? 2 : 1}
                        onChange={(e) => {
                          const value = parseInt(e.target.value);
                          const rating = value === 3 ? 'Gold' : value === 2 ? 'Silver' : 'Bronze';
                          setFormData({ ...formData, rating });
                          console.log('Rating updated:', rating);
                        }}
                        className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
                      />
                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${ratingColors[formData.rating]}`}>
                        {formData.rating}
                      </span>
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray mb-2">Keywords (max 10)</label>
                    <div className="flex gap-3">
                      <input
                        type="text"
                        placeholder="Add keyword"
                        onKeyDown={(e) => {
                          if (e.key === 'Enter') {
                            addKeyword(e.target.value);
                            e.target.value = '';
                            e.preventDefault();
                          }
                        }}
                        className="flex-1 p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                        disabled={formData.keywords.length >= 10}
                      />
                    </div>
                    <div className="flex flex-wrap gap-2 mt-2">
                      {formData.keywords.map((keyword, index) => (
                        <span
                          key={index}
                          className="bg-gray-100 text-gray-800 px-2 py-1 rounded-full flex items-center text-xs font-sans"
                        >
                          {keyword}
                          <button
                            type="button"
                            onClick={() => removeKeyword(index)}
                            className="ml-2 text-red-600 hover:text-red-800"
                          >
                            Ã—
                          </button>
                        </span>
                      ))}
                    </div>
                  </div>
                  <div>
                    <label className="block text-sm font-medium apple-dark-gray mb-2">Remarks</label>
                    <div className="flex gap-3 mb-3">
                      <input
                        type="text"
                        placeholder="Add remark"
                        value={newRemark}
                        onChange={(e) => setNewRemark(e.target.value)}
                        className="flex-1 p-3 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                      />
                      <button
                        type="button"
                        onClick={addRemark}
                        className="px-4 py-2 apple-blue text-white rounded-lg apple-blue-hover text-sm font-medium font-sans apple-transition"
                        disabled={!newRemark.trim()}
                      >
                        Add
                      </button>
                    </div>
                    {formData.remarks.length > 0 && (
                      <ul className="space-y-2">
                        {formData.remarks.map(remark => (
                          <li key={remark.id} className="flex items-center gap-2">
                            {editingRemarkId === remark.id ? (
                              <div className="flex-1 flex gap-2">
                                <input
                                  type="text"
                                  value={editingRemarkText}
                                  onChange={(e) => setEditingRemarkText(e.target.value)}
                                  className="flex-1 p-2 rounded-lg border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[#0071E3] apple-white text-sm font-sans"
                                />
                                <button
                                  type="button"
                                  onClick={saveEditedRemark}
                                  className="px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm font-sans apple-transition"
                                  disabled={!editingRemarkText.trim()}
                                >
                                  Save
                                </button>
                                <button
                                  type="button"
                                  onClick={() => setEditingRemarkId(null)}
                                  className="px-3 py-1 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 text-sm font-sans apple-transition"
                                >
                                  Cancel
                                </button>
                              </div>
                            ) : (
                              <>
                                <span className="flex-1 text-sm apple-dark-gray font-sans">
                                  {remark.text} <span className="text-xs apple-medium-gray">({new Date(remark.createdAt).toLocaleString()})</span>
                                </span>
                                <button
                                  type="button"
                                  onClick={() => editRemark(remark.id, remark.text)}
                                  className="text-[#0071E3] hover:text-[#005BB5] text-sm font-sans"
                                >
                                  Edit
                                </button>
                                <button
                                  type="button"
                                  onClick={() => removeRemark(remark.id)}
                                  className="text-red-500 hover:text-red-700 text-sm font-sans"
                                >
                                  Delete
                                </button>
                              </>
                            )}
                          </li>
                        ))}
                      </ul>
                    )}
                  </div>
                  <div className="flex justify-end gap-3">
                    <button
                      type="button"
                      onClick={onClose}
                      className="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 text-sm font-medium font-sans apple-transition"
                    >
                      Cancel
                    </button>
                    <button
                      type="submit"
                      className="px-4 py-2 apple-blue text-white rounded-lg apple-blue-hover text-sm font-medium font-sans apple-transition"
                    >
                      Save
                    </button>
                  </div>
                </form>
              )}
            </div>
          </div>
        );
      }

      function CandidateCard({ candidate, onView, onEdit, onDelete }) {
        const ratingBadgeColors = {
          Gold: 'bg-yellow-400 text-yellow-900 border-yellow-500',
          Silver: 'bg-gray-400 text-gray-900 border-gray-500',
          Bronze: 'bg-orange-600 text-white border-orange-700'
        };

        console.log('Rendering compact tile for:', candidate.name, 'Size: 25% smaller, enhanced visuals');

        return (
          <div className={`apple-white p-3 rounded-xl shadow-sm hover:shadow-md apple-transition hover-scale border border-gray-100`}>
            <div className="flex justify-between items-start mb-2">
              <img
                src={candidate.linkedin ? `https://api.dicebear.com/9.x/initials/svg?seed=${candidate.name}` : DEFAULT_PHOTO}
                alt={candidate.name}
                className="w-12 h-12 rounded-full object-cover border border-gray-200"
              />
              <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${ratingColors[candidate.rating]}`}>
                {candidate.rating}
              </span>
            </div>
            <h3 className="text-sm font-semibold apple-dark-gray font-sans">{candidate.name}</h3>
            <p className="text-xs apple-medium-gray font-sans">{candidate.function}</p>
            <p className="text-xs apple-medium-gray font-sans">{candidate.company}</p>
            {candidate.linkedin && (
              <a
                href={candidate.linkedin}
                target="_blank"
                rel="noopener noreferrer"
                className="text-[#0071E3] hover:underline text-xs font-sans flex items-center gap-1"
              >
                <svg className="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.024-3.037-1.85-3.037-1.85 0-2.132 1.444-2.132 2.936v5.67H9.357V9h3.414v1.561h.048c.476-.9 1.636-1.85 3.365-1.85 3.602 0 4.263 2.37 4.263 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.93-2.063-2.077 0-1.147.92-2.077 2.063-2.077 1.143 0 2.063.93 2.063 2.077 0 1.147-.92 2.077-2.063 2.077zm1.777 13.019H3.56V9h3.554v11.452zM22.225 0H1.771C.792 0 0 .792 0 1.771v20.458C0 23.208.792 24 1.771 24h20.454c.979 0 1.771-.792 1.771-1.771V1.771C24 .792 23.208 0 22.225 0z"/>
                </svg>
                LinkedIn
              </a>
            )}
            <p className="text-xs apple-medium-gray mt-1.5 font-sans line-clamp-2">{candidate.comments}</p>
            <div className="flex flex-wrap gap-1.5 mt-1.5">
              {candidate.keywords.map((keyword, index) => (
                <span
                  key={index}
                  className="bg-gray-100 text-gray-800 px-1.5 py-0.5 rounded-full text-xs font-sans"
                >
                  {keyword}
                </span>
              ))}
            </div>
            <div className="flex justify-end gap-1.5 mt-2">
              <button
                onClick={onView}
                className="text-[#0071E3] hover:text-[#005BB5] text-xs font-sans apple-transition"
              >
                View
              </button>
              <button
                onClick={onEdit}
                className="text-[#0071E3] hover:text-[#005BB5] text-xs font-sans apple-transition"
              >
                Edit
              </button>
              <button
                onClick={onDelete}
                className="text-red-500 hover:text-red-700 text-xs font-sans apple-transition"
              >
                Delete
              </button>
            </div>
          </div>
        );
      }

      console.log('Rendering application with Apple-inspired theme and new generic logo...');
      try {
        ReactDOM.render(<App />, document.getElementById('root'));
        console.log('Application rendered successfully');
      } catch (e) {
        console.error('Fatal error in rendering:', e.message, e.stack);
        document.getElementById('root').innerHTML = `
          <div style="text-align: center; color: red; padding: 20px;">
            <h1>Error Loading Application</h1>
            <p>Please check the console for details and ensure all scripts loaded correctly.</p>
            <p>Try serving this file via an HTTP server (e.g., 'npx serve' or 'python -m http.server').</p>
          </div>
        `;
      }
    } catch (e) {
      console.error('Fatal error in application initialization:', e.message, e.stack);
      document.getElementById('root').innerHTML = `
        <div style="text-align: center; color: red; padding: 20px;">
          <h1>Error Loading Application</h1>
          <p>Please check the console for details and ensure all scripts loaded correctly.</p>
          <p>Try serving this file via an HTTP server (e.g., 'npx serve' or 'python -m http.server').</p>
        </div>
      `;
    }
  </script>
</body>
</html>
